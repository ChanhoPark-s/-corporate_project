<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.spring.mapper.ItemMapper">

	<select id="selectAll" resultType="com.spring.domain.ItemVO">
		select item.no, item.code, client.code as client_code, item.name, item.in_price, item.out_price, item.image
		from item, client
		where item.client_no = client.no
		<if test="whatColumn == 'code'"> and item.code like '%' || #{keyword} || '%' </if>
		<if test="whatColumn =='client_code'"> and client.code like '%' || #{keyword} || '%' </if>
		<if test="whatColumn =='name'"> and item.name like '%' || #{keyword} || '%' </if>
		order by no  desc OFFSET #{beginRow} ROWS FETCH NEXT #{pageSize} ROWS ONLY
	</select>
	<insert id="insert">
		insert into item
		values (item_seq.nextval,#{client_no},#{code}, #{name}, #{in_price}, #{out_price}, #{image})
	</insert>
	
	<delete id="delete">
		delete item where no = #{no}
	</delete>
	
	<select id="selectOne" resultType="com.spring.domain.ItemVO">
		select * from item where no=#{value}
	</select>
	
	<update id="update">
		update item set client_no=#{client_no}, code=#{code}, name=#{name}, in_price=#{in_price}, out_pirce=#{out_price}, image=#{image}
		where no=#{no}
	</update>
	
	<select id="getTotalCount" resultType="int">
  	select count(*) from client c,item i where i.client_no = c.no
  	<if test="whatColumn == 'code'">
  		and i.code like '%' || #{keyword} || '%'  
  	</if>
  	<if test="whatColumn == 'client_code'">
  		and c.code like '%' || #{keyword} || '%'
  	</if>
  	<if test="whatColumn == 'name'">
  		and i.name like '%' || #{keyword} || '%'
  	</if>
  </select>
 	<select id="code_check" parameterType="com.spring.domain.ItemVO" resultType="int">
		select count(code) from item where code=#{code}
	</select>
	
</mapper>